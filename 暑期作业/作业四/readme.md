# 作业说明


## 介绍
#### 此次作业是使用Pytorch来对经典的一些CNN网络进行实现，像有一些经典的网络有VGG、ResNet、GoogLeNet、AlexNet等等，但由于电脑性能的原因，所以没有对所有的经典网络进行实现。所以这里主要是对AlexNet和ResNet网络进行了实现，使用的是这些模型的预训练模型。为了不对模型有大的改变，这里只对模型的第一层和最后一层进行了修改，这样可以加快模型的训练速度。 ####

#### 除了对经典模型进行实现外，我还使用Pytorch自己搭建了一个小型的网络，然后对其进行训练，然后在测试集上测试其性能。 ####

## 数据集
#### 这里使用的数据集主要是MNIST，因为其是单通道的，所以其计算量要想对小一点， 其尺寸是28 * 28，在自己搭建的网络上进行训练时，只需要将图片放入网络中训练就行了，但是在经典网络上时，需要对图片的大小进行修改，以此来满足这些模型的输入要求。 ####

## 自己搭建的网络(见文件Demo.py)
#### 网络参数如下 ####
|conv layer|feature size|output size|
|:--------:|:----------:|:---------:|
|conv1|5 * 5, 5|28 * 28|
|conv2|3 * 3, 5|28 * 28|
|pool|2 * 2| 14 * 14|

|fully connected| weight size |
|:------------:|:-----------:|
|fc1|(14 * 14 * 5, 20)|
|fc2|(20, 10)|

上面的表格是对模型的整体结构进行简要的说明。其中，卷积层我们在每次卷积后就对进行Batch Norm，然后是采用激活函数ReLU。使用Batch Norm的目的是加快模型的训练速度，同时也可以保证训练的稳定。在实验过程中，不加Batch Norm的测试效果比较差，而加上之后，精度得到很大的提升，收敛速度也变快了。在全连接层，我在第一层全联接层后加上了ReLU，然后在最后输出的时候加上了Softmax，用于实现多分类。

我在训练的时候，采用的是交叉熵损失函数，使用Adam优化方法，学习率为1e-3。然后训练集为50000张，验证集10000张，测试集10000张。我使用的是mini batch方法，每次拿出500张进行训练，然后100次后，一个迭代结束，然后以此进行10次迭代。在每25次训练之后，我会将模型在训练集和验证集上进行测试，用以显示模型的训练效果，显示有没有过拟合等问题。在训练完成之后，再在测试集上进行预测，显示最后的结果。再最后将损失值和训练过程中的精度进行可视化。

#### 在对模型进行训练之后，在验证集上的结果能拟合的很好，说明没有发生过拟合。在测试集上能达到98%的精确度。由于MNIST数据集是单通道的，而且其识别比较简单，所以此模型也只能在这个数据集上有好的表现，在其他数据集上可能就没有这么好了。

## AlexNet
由于Pytorch提供了此模型的的接口，而且还提供其预训练模型，所有，我便在此模型的基础上只对其第一层卷积层和最后一层全连接层进行了修改，中间的部分都没有修改。对于AlexNet的具体结构，可以参考其[源码][1]。对于改动的部分，我只是将三通道改成了单通道，类别从1000变成了10。

训练的时候，我只拿了训练集10000张，验证集1000张，测试集1000，因为我的电脑没有N卡，所以无法使用GPU来进行训练，所以，训练的数据集大小也变小了。我采用的损失函数依然是交叉熵，优化方法是Adam，学习率是1e-4。训练的过程跟上面的类似，只不过将mini batch改成了100，每次都将模型在验证集上的结果保存，用于测试模型的拟合程度。最后将模型的训练结果在测试集上进行进行测试。然后进行可视化。

#### 最后的结果显示，AlexNet网络在MNIST上的精度能达到98.1%

## ResNet
作为著名的残差网络，这个网络在很多场景上都有很好的表现。其模型具体结构可以查看[源码][2]。同AlexNet，我对此模型的修改跟上面的完全一致。

在训练的时候，数据集大小又进行了修改。由于ResNet152的深度，所以训练的运算量相比AlexNet来说又上升了，所以在这里的训练集是1000张，验证集100张，测试集100张，mini batch大小改为了10，每次都将模型在验证集上的结果保存，用于测试模型的拟合程度。最后将模型的训练结果在测试集上进行进行测试。然后进行可视化。其它方面和在训练AlexNet的时候都是一样的。

#### 训练的模型在测试集上的表现还是很不错的，精度达到了99%。
### 注：由于使用已有的模型只需要做一些小小的修改，所以在这里就只提供ResNet的实现代码。见文件Model.py

[1]: https://pytorch.org/docs/stable/_modules/torchvision/models/alexnet.html#alexnet
[2]: https://pytorch.org/docs/stable/_modules/torchvision/models/resnet.html#resnet18